SET SCHEMA PAY_TEST;

TRUNCATE SCHEMA PAY_TEST RESTART IDENTITY AND COMMIT;

DROP TABLE PAY_TEST_CASE_EXPECTION IF EXISTS;
DROP TABLE PAY_FILE_ENRICHMENT IF EXISTS;
DROP TABLE PAY_FILE_ELEMENT IF EXISTS;
DROP TABLE PAY_TEST_CASE IF EXISTS;
DROP TABLE PAY_SUB_TYPE IF EXISTS;
DROP TABLE PAY_TYPE IF EXISTS;
DROP TABLE FILE_ORIGIN IF EXISTS;
DROP TABLE PAY_ENTITY IF EXISTS;

CREATE TABLE PAY_ENTITY(
ENTITY_CODE VARCHAR(10) NOT NULL,
COUNTRY_CODE2 VARCHAR(2),
COUNTRY_CODE3 VARCHAR(3),
PRIMARY KEY (ENTITY_CODE)
);
CREATE TABLE FILE_ORIGIN(
ORIGIN_CODE VARCHAR(10) NOT NULL,
PRIMARY KEY (ORIGIN_CODE)
);
CREATE TABLE PAY_TYPE(
PAY_TYPE_CODE VARCHAR(20) NOT NULL,
PRIMARY KEY (PAY_TYPE_CODE)
);
CREATE TABLE PAY_SUB_TYPE(
PAY_SUB_TYPE_ID INTEGER NOT NULL generated by default as identity (start with 1),
PAY_TYPE_CODE VARCHAR(20) NOT NULL,
PAY_SUB_TYPE_CODE VARCHAR(10) NOT NULL,
FOREIGN KEY (PAY_TYPE_CODE) REFERENCES PAY_TYPE(PAY_TYPE_CODE),
PRIMARY KEY (PAY_SUB_TYPE_ID)
);
CREATE TABLE PAY_TEST_CASE(
PAY_TEST_CASE_ID INTEGER NOT NULL generated by default as identity (start with 1),
ENTITY_CODE VARCHAR(10) NOT NULL,
ORIGIN_CODE VARCHAR(10) NOT NULL,
PAY_SUB_TYPE_ID INTEGER,
TEST_CASE_NAME VARCHAR(20),
TEST_CASE_DESCPRIPTION VARCHAR(1000),
FOREIGN KEY (ENTITY_CODE) REFERENCES PAY_ENTITY(ENTITY_CODE),
FOREIGN KEY (ORIGIN_CODE) REFERENCES FILE_ORIGIN(ORIGIN_CODE),
FOREIGN KEY (PAY_SUB_TYPE_ID) REFERENCES PAY_SUB_TYPE(PAY_SUB_TYPE_ID),
PRIMARY KEY (PAY_TEST_CASE_ID)
);

CREATE TABLE PAY_FILE_ELEMENT(
ELEMENT_ID INTEGER NOT NULL generated by default as identity (start with 1),
ELEMENT_LEVEL VARCHAR (10),
ELEMENT_NAME VARCHAR(10),
ELEMENT_XPATH VARCHAR(1000),
ELEMENT_DEFAULT_VALUE VARCHAR(1000),
ELEMENT_IS_RANDOM CHAR(1),
PRIMARY KEY (ELEMENT_ID)
);

CREATE TABLE PAY_TEST_CASE_EXPECTION(
EXPECTION_ID INTEGER NOT NULL generated by default as identity (start with 1),
PAY_TEST_CASE_ID INTEGER NOT NULL,
EXPECTED_TABLE VARCHAR(100),
EXPECTED_FIELD VARCHAR(100),
EXPECTED_VALUE VARCHAR(1000),
FOREIGN KEY (PAY_TEST_CASE_ID) REFERENCES PAY_TEST_CASE(PAY_TEST_CASE_ID),
PRIMARY KEY (EXPECTION_ID)
);

CREATE TABLE RANDOM_VALUES_ENRIRCHEMENT(
RANDOM_ID INTEGER NOT NULL,
DATA_TYPE VARCHAR(20) NOT NULL,
PREFIX_LENGTH INTEGER NOT NULL,
SUFFIX_LENGTH INTEGER NOT NULL,
APPENDER VARCHAR(5),
PRIMARY KEY (RANDOM_ID)
);


CREATE TABLE PAY_FILE_ENRICHMENT(
PAY_FILE_ENRICHMENT_ID INTEGER NOT NULL generated by default as identity (start with 1),
PAY_TEST_CASE_ID INTEGER NOT NULL,
ELEMENT_ID INTEGER NOT NULL,
ELEMENT_VALUE VARCHAR(10000),
RANDOM_ID INTEGER,
FOREIGN KEY (RANDOM_ID) REFERENCES RANDOM_VALUES_ENRIRCHEMENT(RANDOM_ID),
FOREIGN KEY (PAY_TEST_CASE_ID) REFERENCES PAY_TEST_CASE(PAY_TEST_CASE_ID),
FOREIGN KEY (ELEMENT_ID) REFERENCES PAY_FILE_ELEMENT(ELEMENT_ID),
PRIMARY KEY (PAY_TEST_CASE_ID)
)

